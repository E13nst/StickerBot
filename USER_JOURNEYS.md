# ะกัะตะผั ะฟะพะปัะทะพะฒะฐัะตะปััะบะธั ะฟััะตะน ะฒ StickerBot

ะญัะพั ะดะพะบัะผะตะฝั ะพะฟะธััะฒะฐะตั ะฒัะต ะฟะพะปัะทะพะฒะฐัะตะปััะบะธะต ะฟััะธ (user journeys) ะฒะฝัััะธ Telegram-ะฑะพัะฐ StickerBot. ะะดะตัั ะฟัะตะดััะฐะฒะปะตะฝั ะดะธะฐะณัะฐะผะผั ะฟะตัะตัะพะดะพะฒ ะผะตะถะดั ัะพััะพัะฝะธัะผะธ, ะฟะพัะปะตะดะพะฒะฐัะตะปัะฝะพััะธ ะดะตะนััะฒะธะน ะธ ัะฟัะฐะฒะพัะฝะฐั ะธะฝัะพัะผะฐัะธั ะพ ััััะบัััะต ะฑะพัะฐ.

## ะกะพะดะตัะถะฐะฝะธะต

1. [ะะฑัะฐั ััััะบัััะฐ ะฝะฐะฒะธะณะฐัะธะธ](#ะพะฑัะฐั-ััััะบัััะฐ-ะฝะฐะฒะธะณะฐัะธะธ)
2. [ะััั 1: ะะพะธัะบ ััะธะบะตัะฐ ะฒ ะณะฐะปะตัะตะต](#ะฟััั-1-ะฟะพะธัะบ-ััะธะบะตัะฐ-ะฒ-ะณะฐะปะตัะตะต)
3. [ะััั 2: ะะพะฑะฐะฒะปะตะฝะธะต ััะธะบะตััะตัะฐ ะฒ ะณะฐะปะตัะตั](#ะฟััั-2-ะดะพะฑะฐะฒะปะตะฝะธะต-ััะธะบะตััะตัะฐ-ะฒ-ะณะฐะปะตัะตั)
4. [ะััั 3: ะกะพะทะดะฐะฝะธะต ะฝะพะฒะพะณะพ ััะธะบะตััะตัะฐ](#ะฟััั-3-ัะพะทะดะฐะฝะธะต-ะฝะพะฒะพะณะพ-ััะธะบะตััะตัะฐ)
5. [ะััั 4: ะะพะฑะฐะฒะปะตะฝะธะต ััะธะบะตัะฐ ะฒ ัััะตััะฒัััะธะน ััะธะบะตััะตั](#ะฟััั-4-ะดะพะฑะฐะฒะปะตะฝะธะต-ััะธะบะตัะฐ-ะฒ-ัััะตััะฒัััะธะน-ััะธะบะตััะตั)
6. [ะััั 5: ะฃะฟัะฐะฒะปะตะฝะธะต ะฟัะฑะปะธะบะฐัะธะตะน](#ะฟััั-5-ัะฟัะฐะฒะปะตะฝะธะต-ะฟัะฑะปะธะบะฐัะธะตะน)
7. [ะะตัะฐะปัะฝัะต ะฟะพัะพะบะธ](#ะดะตัะฐะปัะฝัะต-ะฟะพัะพะบะธ)
8. [ะขะฐะฑะปะธัะฐ ัะพััะพัะฝะธะน](#ัะฐะฑะปะธัะฐ-ัะพััะพัะฝะธะน-ะฑะพัะฐ)
9. [Callback-ะดะฐะฝะฝัะต](#callback-ะดะฐะฝะฝัะต-callback_data)
10. [ะะฑัะฐั ััะตะผะฐ ะฟะตัะตัะพะดะพะฒ](#ะพะฑัะฐั-ััะตะผะฐ-ะฟะตัะตัะพะดะพะฒ-ะผะตะถะดั-ัะพััะพัะฝะธัะผะธ)

## ะะฑัะฐั ััััะบัััะฐ ะฝะฐะฒะธะณะฐัะธะธ

```mermaid
graph TD
    Start[/start] --> MainMenu[ะะปะฐะฒะฝะพะต ะผะตะฝั<br/>CHOOSING_ACTION]
    
    MainMenu --> WebApp[๐ ะะฐะนัะธ ััะธะบะตั ะฒ ะณะฐะปะตัะตะต<br/>WebApp - ะฒะฝะตัะฝะตะต ะฟัะธะปะพะถะตะฝะธะต]
    MainMenu --> AddPack[โ ะะพะฑะฐะฒะธัั ััะธะบะตััะตั ะฒ ะณะฐะปะตัะตั<br/>WAITING_STICKER_PACK_LINK]
    MainMenu --> ManageBtn[๐ ะฃะฟัะฐะฒะปะตะฝะธะต ััะธะบะตัะฐะผะธ<br/>callback: manage_stickers_menu]
    
    ManageBtn --> ManageMenu[ะะพะดะผะตะฝั ัะฟัะฐะฒะปะตะฝะธั<br/>CHOOSING_ACTION]
    
    ManageMenu --> CreateNew[ะกะพะทะดะฐัั ะฝะพะฒัะน ััะธะบะตััะตั<br/>WAITING_NEW_TITLE]
    ManageMenu --> AddExisting[ะะพะฑะฐะฒะธัั ะฒ ัััะตััะฒัััะธะน<br/>WAITING_EXISTING_CHOICE]
    ManageMenu --> ManagePub[ะฃะฟัะฐะฒะปััั ะฟัะฑะปะธะบะฐัะธะตะน<br/>WAITING_MANAGE_CHOICE]
    ManageMenu --> BackMain[ะะฐะทะฐะด ะฒ ะณะปะฐะฒะฝะพะต ะผะตะฝั<br/>callback: back_to_main]
    
    WebApp -.->|ะฒะพะทะฒัะฐั| MainMenu
    AddPack --> MainMenu
    CreateNew --> MainMenu
    AddExisting --> MainMenu
    ManagePub --> MainMenu
    BackMain --> MainMenu
    
    style MainMenu fill:#e1f5ff
    style ManageMenu fill:#fff4e1
```

## ะััั 1: ะะพะธัะบ ััะธะบะตัะฐ ะฒ ะณะฐะปะตัะตะต

```mermaid
sequenceDiagram
    participant User as ะะพะปัะทะพะฒะฐัะตะปั
    participant Bot as ะะพั
    participant WebApp as WebApp ะะฐะปะตัะตะธ
    
    User->>Bot: /start
    Bot->>User: ะะปะฐะฒะฝะพะต ะผะตะฝั
    User->>Bot: ะะฐะถะฐัั "๐ ะะฐะนัะธ ััะธะบะตั ะฒ ะณะฐะปะตัะตะต"
    Bot->>WebApp: ะัะบัััั WebApp
    User->>WebApp: ะะพะธัะบ/ะฟัะพัะผะพัั ััะธะบะตัะพะฒ
    WebApp->>User: ะัะพะฑัะฐะถะตะฝะธะต ะณะฐะปะตัะตะธ
```

## ะััั 2: ะะพะฑะฐะฒะปะตะฝะธะต ััะธะบะตััะตัะฐ ะฒ ะณะฐะปะตัะตั

```mermaid
stateDiagram-v2
    [*] --> CHOOSING_ACTION: /start
    
    CHOOSING_ACTION --> WAITING_STICKER_PACK_LINK: ะะฐะถะฐัั "โ ะะพะฑะฐะฒะธัั ััะธะบะตััะตั ะฒ ะณะฐะปะตัะตั"
    
    WAITING_STICKER_PACK_LINK --> WAITING_STICKER_PACK_LINK: ะัะฟัะฐะฒะธัั ัะตะบัั/ะฝะต ััะธะบะตั<br/>(ะพัะธะฑะบะฐ)
    WAITING_STICKER_PACK_LINK --> CHOOSING_ACTION: ะัะฟัะฐะฒะธัั ััะธะบะตั<br/>(ะพะฑัะฐะฑะพัะบะฐ, ะฒะพะทะฒัะฐั ะฒ ะผะตะฝั)
    
    CHOOSING_ACTION --> [*]: /cancel
    WAITING_STICKER_PACK_LINK --> [*]: /cancel
```

## ะััั 3: ะกะพะทะดะฐะฝะธะต ะฝะพะฒะพะณะพ ััะธะบะตััะตัะฐ

```mermaid
stateDiagram-v2
    [*] --> CHOOSING_ACTION: /start
    
    CHOOSING_ACTION --> CHOOSING_ACTION: ะะฐะถะฐัั "๐ ะฃะฟัะฐะฒะปะตะฝะธะต ััะธะบะตัะฐะผะธ"<br/>(ะฟะพะบะฐะทะฐัั ะฟะพะดะผะตะฝั)
    CHOOSING_ACTION --> WAITING_NEW_TITLE: ะัะฑัะฐัั "ะกะพะทะดะฐัั ะฝะพะฒัะน ััะธะบะตััะตั"<br/>(manage:create_new)
    
    WAITING_NEW_TITLE --> WAITING_NEW_TITLE: ะัััะพะต ะฝะฐะทะฒะฐะฝะธะต<br/>(ะฟะพะฒัะพั)
    WAITING_NEW_TITLE --> WAITING_STICKER: ะะฒะตััะธ ะฝะฐะทะฒะฐะฝะธะต
    
    WAITING_STICKER --> WAITING_STICKER: ะะตะฒะตัะฝัะน ัะพัะผะฐั<br/>(ะฟะพะฒัะพั)
    WAITING_STICKER --> WAITING_EMOJI: ะัะฟัะฐะฒะธัั ะธะทะพะฑัะฐะถะตะฝะธะต<br/>(ะบะพะฝะฒะตััะฐัะธั ะฒ WebP)
    
    WAITING_EMOJI --> WAITING_STICKER: ะัะธะฑะบะฐ ัะพะฟะพััะฐะฒะปะตะฝะธั<br/>(ะฒะตัะฝััััั ะบ ััะธะบะตัั)
    WAITING_EMOJI --> WAITING_DECISION: ะะฒะตััะธ ัะผะพะดะทะธ<br/>(ััะธะบะตั ะดะพะฑะฐะฒะปะตะฝ ะฒ ัะฟะธัะพะบ)
    
    WAITING_DECISION --> WAITING_STICKER: ะัะฟัะฐะฒะธัั ะตัั ััะธะบะตั
    WAITING_DECISION --> WAITING_DECISION: ะัะฟัะฐะฒะธัั ัะตะบัั<br/>(ะฟะพะดัะบะฐะทะบะฐ)
    WAITING_DECISION --> WAITING_SHORT_NAME: ะะฐะถะฐัั "ะะพัะพะฒะพ"
    
    WAITING_SHORT_NAME --> WAITING_SHORT_NAME: ะะตะฒะตัะฝัะน ัะพัะผะฐั/ะทะฐะฝััะพ<br/>(ะฟะพะฒัะพั)
    WAITING_SHORT_NAME --> WAITING_PUBLISH_DECISION: ะฃัะฟะตัะฝะพะต ัะพะทะดะฐะฝะธะต<br/>(ัะพััะฐะฝะตะฝะธะต ะฒ ะณะฐะปะตัะตะต)
    WAITING_SHORT_NAME --> [*]: ะัะธะฑะบะฐ ัะพะทะดะฐะฝะธั
    
    WAITING_PUBLISH_DECISION --> [*]: ะัะฑะพั ะฟัะฑะปะธะบะฐัะธะธ<br/>(publish:yes/no)
    
    CHOOSING_ACTION --> [*]: /cancel
    WAITING_NEW_TITLE --> [*]: /cancel
    WAITING_STICKER --> [*]: /cancel
    WAITING_EMOJI --> [*]: /cancel
    WAITING_DECISION --> [*]: /cancel
    WAITING_SHORT_NAME --> [*]: /cancel
    WAITING_PUBLISH_DECISION --> [*]: /cancel
```

## ะััั 4: ะะพะฑะฐะฒะปะตะฝะธะต ััะธะบะตัะฐ ะฒ ัััะตััะฒัััะธะน ััะธะบะตััะตั

```mermaid
stateDiagram-v2
    [*] --> CHOOSING_ACTION: /start
    
    CHOOSING_ACTION --> CHOOSING_ACTION: ะะฐะถะฐัั "๐ ะฃะฟัะฐะฒะปะตะฝะธะต ััะธะบะตัะฐะผะธ"<br/>(ะฟะพะบะฐะทะฐัั ะฟะพะดะผะตะฝั)
    CHOOSING_ACTION --> WAITING_EXISTING_CHOICE: ะัะฑัะฐัั "ะะพะฑะฐะฒะธัั ะฒ ัััะตััะฒัััะธะน"<br/>(manage:add_existing)<br/>ะะพะบะฐะทะฐัั ัะฟะธัะพะบ ะฝะฐะฑะพัะพะฒ
    
    WAITING_EXISTING_CHOICE --> WAITING_EXISTING_CHOICE: ะะธััะฐัั ัััะฐะฝะธัั<br/>(page:next/prev)
    WAITING_EXISTING_CHOICE --> WAITING_STICKER: ะัะฑัะฐัั ะฝะฐะฑะพั<br/>(set:index)
    WAITING_EXISTING_CHOICE --> [*]: ะัะผะตะฝะฐ (action:cancel)
    WAITING_EXISTING_CHOICE --> WAITING_EXISTING_CHOICE: ะัะฟัะฐะฒะธัั ัะตะบัั<br/>(ะฟะพะดัะบะฐะทะบะฐ)
    
    WAITING_STICKER --> WAITING_STICKER: ะะตะฒะตัะฝัะน ัะพัะผะฐั<br/>(ะฟะพะฒัะพั)
    WAITING_STICKER --> WAITING_STICKER: ะะฐะฑะพั ะฝะต ะฒัะฑัะฐะฝ<br/>(ะฒะตัะฝััััั ะบ ัะฟะธัะบั)
    WAITING_STICKER --> WAITING_EMOJI: ะัะฟัะฐะฒะธัั ะธะทะพะฑัะฐะถะตะฝะธะต<br/>(ะบะพะฝะฒะตััะฐัะธั ะฒ WebP)
    
    WAITING_EMOJI --> WAITING_STICKER: ะัะธะฑะบะฐ ัะพะฟะพััะฐะฒะปะตะฝะธั<br/>(ะฒะตัะฝััััั ะบ ััะธะบะตัั)
    WAITING_EMOJI --> WAITING_DECISION: ะะฒะตััะธ ัะผะพะดะทะธ<br/>(ััะธะบะตั ะดะพะฑะฐะฒะปะตะฝ ะฒ ะฝะฐะฑะพั)
    
    WAITING_DECISION --> WAITING_STICKER: ะัะฟัะฐะฒะธัั ะตัั ััะธะบะตั
    WAITING_DECISION --> WAITING_DECISION: ะัะฟัะฐะฒะธัั ัะตะบัั<br/>(ะฟะพะดัะบะฐะทะบะฐ)
    WAITING_DECISION --> [*]: ะะฐะถะฐัั "ะะพัะพะฒะพ"
    
    CHOOSING_ACTION --> [*]: /cancel
    WAITING_EXISTING_CHOICE --> [*]: /cancel
    WAITING_STICKER --> [*]: /cancel
    WAITING_EMOJI --> [*]: /cancel
    WAITING_DECISION --> [*]: /cancel
```

## ะััั 5: ะฃะฟัะฐะฒะปะตะฝะธะต ะฟัะฑะปะธะบะฐัะธะตะน

```mermaid
stateDiagram-v2
    [*] --> CHOOSING_ACTION: /start
    
    CHOOSING_ACTION --> CHOOSING_ACTION: ะะฐะถะฐัั "๐ ะฃะฟัะฐะฒะปะตะฝะธะต ััะธะบะตัะฐะผะธ"<br/>(ะฟะพะบะฐะทะฐัั ะฟะพะดะผะตะฝั)
    CHOOSING_ACTION --> WAITING_MANAGE_CHOICE: ะัะฑัะฐัั "ะฃะฟัะฐะฒะปััั ะฟัะฑะปะธะบะฐัะธะตะน"<br/>(manage:publication)<br/>ะะพะบะฐะทะฐัั ัะฟะธัะพะบ ะฝะฐะฑะพัะพะฒ ั ะธะบะพะฝะบะฐะผะธ
    
    WAITING_MANAGE_CHOICE --> WAITING_MANAGE_CHOICE: ะะธััะฐัั ัััะฐะฝะธัั<br/>(manage:page:next/prev)
    WAITING_MANAGE_CHOICE --> WAITING_MANAGE_CHOICE: ะัะฑัะฐัั ะฝะฐะฑะพั<br/>(manage:set:index)<br/>ะะพะบะฐะทะฐัั ััะฐััั: ะฟัะฑะปะธัะฝัะน/ะฟัะธะฒะฐัะฝัะน
    WAITING_MANAGE_CHOICE --> WAITING_MANAGE_CHOICE: ะกะฝััั ั ะฟัะฑะปะธะบะฐัะธะธ<br/>(manage:unpublish)<br/>ะัะปะธ ะฟัะฑะปะธัะฝัะน
    WAITING_MANAGE_CHOICE --> WAITING_MANAGE_CHOICE: ะะตัะฝััััั ะบ ัะฟะธัะบั<br/>(manage:back)
    WAITING_MANAGE_CHOICE --> [*]: ะัะผะตะฝะฐ (manage:cancel)
    WAITING_MANAGE_CHOICE --> WAITING_MANAGE_CHOICE: ะัะฟัะฐะฒะธัั ัะตะบัั<br/>(ะฟะพะดัะบะฐะทะบะฐ)
    
    CHOOSING_ACTION --> [*]: /cancel
    WAITING_MANAGE_CHOICE --> [*]: /cancel
```

## ะะตัะฐะปัะฝัะน ะฟะพัะพะบ ัะพะทะดะฐะฝะธั ะฝะพะฒะพะณะพ ััะธะบะตััะตัะฐ

```mermaid
flowchart TD
    Start([/start]) --> MainMenu[ะะปะฐะฒะฝะพะต ะผะตะฝั]
    MainMenu --> ManageBtn[ะะฐะถะฐัั: ะฃะฟัะฐะฒะปะตะฝะธะต ััะธะบะตัะฐะผะธ]
    ManageBtn --> CreateBtn[ะะฐะถะฐัั: ะกะพะทะดะฐัั ะฝะพะฒัะน ััะธะบะตััะตั]
    
    CreateBtn --> Title[ะะฒะตััะธ ะฝะฐะทะฒะฐะฝะธะต ะฝะฐะฑะพัะฐ<br/>WAITING_NEW_TITLE]
    Title -->|ะัััะพะต| Title
    Title -->|ะะฐะปะธะดะฝะพะต ะฝะฐะทะฒะฐะฝะธะต| Sticker1[ะัะฟัะฐะฒะธัั ะธะทะพะฑัะฐะถะตะฝะธะต<br/>WAITING_STICKER]
    
    Sticker1 -->|ะัะธะฑะบะฐ| Sticker1
    Sticker1 -->|ะฃัะฟะตั| Emoji1[ะะฒะตััะธ ัะผะพะดะทะธ<br/>WAITING_EMOJI]
    
    Emoji1 -->|ะัะธะฑะบะฐ| Sticker1
    Emoji1 -->|ะฃัะฟะตั| Decision{ะะพะฑะฐะฒะธัั ะตัั?<br/>WAITING_DECISION}
    
    Decision -->|ะัะฟัะฐะฒะธัั ััะธะบะตั| Sticker1
    Decision -->|ะขะตะบัั| Decision
    Decision -->|ะะพัะพะฒะพ| ShortName[ะะฒะตััะธ ะบะพัะพัะบะพะต ะธะผั<br/>WAITING_SHORT_NAME]
    
    ShortName -->|ะะตะฒะตัะฝัะน ัะพัะผะฐั/ะทะฐะฝััะพ| ShortName
    ShortName -->|ะะฐะปะธะดะฝะพะต| Create[ะกะพะทะดะฐัั ััะธะบะตััะตั]
    
    Create -->|ะฃัะฟะตั| Publish{ะะฟัะฑะปะธะบะพะฒะฐัั?<br/>WAITING_PUBLISH_DECISION}
    Create -->|ะัะธะฑะบะฐ| ShortName
    
    Publish -->|ะะฐ| PublishYes[ะะฟัะฑะปะธะบะพะฒะฐัั ะฒ ะณะฐะปะตัะตะต]
    Publish -->|ะะตั| End1[ะะฐะฒะตััะธัั]
    PublishYes --> End1
    
    End1([ะะฐะฒะตััะตะฝะธะต])
```

## ะะตัะฐะปัะฝัะน ะฟะพัะพะบ ะดะพะฑะฐะฒะปะตะฝะธั ะฒ ัััะตััะฒัััะธะน ะฝะฐะฑะพั

```mermaid
flowchart TD
    Start([/start]) --> MainMenu[ะะปะฐะฒะฝะพะต ะผะตะฝั]
    MainMenu --> ManageBtn[ะะฐะถะฐัั: ะฃะฟัะฐะฒะปะตะฝะธะต ััะธะบะตัะฐะผะธ]
    ManageBtn --> AddBtn[ะะฐะถะฐัั: ะะพะฑะฐะฒะธัั ะฒ ัััะตััะฒัััะธะน]
    
    AddBtn --> ShowSets[ะะพะบะฐะทะฐัั ัะฟะธัะพะบ ะฝะฐะฑะพัะพะฒ<br/>WAITING_EXISTING_CHOICE]
    ShowSets -->|ะะธััะฐัั| ShowSets
    ShowSets -->|ะัะผะตะฝะฐ| End2[ะะฐะฒะตััะธัั]
    ShowSets -->|ะัะฑัะฐัั ะฝะฐะฑะพั| Sticker2[ะัะฟัะฐะฒะธัั ะธะทะพะฑัะฐะถะตะฝะธะต<br/>WAITING_STICKER]
    
    Sticker2 -->|ะัะธะฑะบะฐ| Sticker2
    Sticker2 -->|ะฃัะฟะตั| Emoji2[ะะฒะตััะธ ัะผะพะดะทะธ<br/>WAITING_EMOJI]
    
    Emoji2 -->|ะัะธะฑะบะฐ| Sticker2
    Emoji2 -->|ะฃัะฟะตั| AddSticker[ะะพะฑะฐะฒะธัั ััะธะบะตั ะฒ ะฝะฐะฑะพั]
    
    AddSticker -->|ะัะธะฑะบะฐ| ShowSets
    AddSticker -->|ะฃัะฟะตั| Decision2{ะะพะฑะฐะฒะธัั ะตัั?<br/>WAITING_DECISION}
    
    Decision2 -->|ะัะฟัะฐะฒะธัั ััะธะบะตั| Sticker2
    Decision2 -->|ะขะตะบัั| Decision2
    Decision2 -->|ะะพัะพะฒะพ| End2
    
    End2([ะะฐะฒะตััะตะฝะธะต])
```

## ะขะฐะฑะปะธัะฐ ัะพััะพัะฝะธะน ะฑะพัะฐ

| ะกะพััะพัะฝะธะต | ะะพะด | ะะฟะธัะฐะฝะธะต |
|-----------|-----|----------|
| `CHOOSING_ACTION` | 0 | ะะปะฐะฒะฝะพะต ะผะตะฝั, ะฒัะฑะพั ะดะตะนััะฒะธั |
| `WAITING_NEW_TITLE` | 1 | ะะถะธะดะฐะฝะธะต ะฝะฐะทะฒะฐะฝะธั ะฝะพะฒะพะณะพ ััะธะบะตััะตัะฐ |
| `WAITING_STICKER` | 2 | ะะถะธะดะฐะฝะธะต ะธะทะพะฑัะฐะถะตะฝะธั ััะธะบะตัะฐ |
| `WAITING_EMOJI` | 3 | ะะถะธะดะฐะฝะธะต ัะผะพะดะทะธ ะดะปั ััะธะบะตัะฐ |
| `WAITING_DECISION` | 4 | ะะถะธะดะฐะฝะธะต ัะตัะตะฝะธั (ะดะพะฑะฐะฒะธัั ะตัั ะธะปะธ ะณะพัะพะฒะพ) |
| `WAITING_SHORT_NAME` | 5 | ะะถะธะดะฐะฝะธะต ะบะพัะพัะบะพะณะพ ะธะผะตะฝะธ ะดะปั ััะธะบะตััะตัะฐ |
| `WAITING_EXISTING_CHOICE` | 6 | ะะถะธะดะฐะฝะธะต ะฒัะฑะพัะฐ ัััะตััะฒัััะตะณะพ ะฝะฐะฑะพัะฐ |
| `WAITING_PUBLISH_DECISION` | 7 | ะะถะธะดะฐะฝะธะต ัะตัะตะฝะธั ะพ ะฟัะฑะปะธะบะฐัะธะธ |
| `WAITING_MANAGE_CHOICE` | 8 | ะะถะธะดะฐะฝะธะต ะฒัะฑะพัะฐ ะฝะฐะฑะพัะฐ ะดะปั ัะฟัะฐะฒะปะตะฝะธั ะฟัะฑะปะธะบะฐัะธะตะน |
| `WAITING_STICKER_PACK_LINK` | 9 | ะะถะธะดะฐะฝะธะต ััะธะบะตัะฐ ะดะปั ะดะพะฑะฐะฒะปะตะฝะธั ััะธะบะตััะตัะฐ ะฒ ะณะฐะปะตัะตั |

## ะัะฝะพะฒะฝัะต ะดะตะนััะฒะธั ะธ ะฟะตัะตัะพะดั

### ะะปะฐะฒะฝะพะต ะผะตะฝั (CHOOSING_ACTION)
- **ะัะพะด:** `/start`, `back_to_main`
- **ะััะพะด:**
  - WebApp (ะฟะพะธัะบ ะฒ ะณะฐะปะตัะตะต)
  - `WAITING_STICKER_PACK_LINK` (ะดะพะฑะฐะฒะธัั ััะธะบะตััะตั)
  - `WAITING_EXISTING_CHOICE` (ัะฟัะฐะฒะปะตะฝะธะต โ ะดะพะฑะฐะฒะธัั ะฒ ัััะตััะฒัััะธะน)
  - `WAITING_NEW_TITLE` (ัะฟัะฐะฒะปะตะฝะธะต โ ัะพะทะดะฐัั ะฝะพะฒัะน)
  - `WAITING_MANAGE_CHOICE` (ัะฟัะฐะฒะปะตะฝะธะต โ ะฟัะฑะปะธะบะฐัะธั)

### ะัะผะตะฝะฐ (`/cancel`)
- ะะพัััะฟะฝะฐ ะฒ ะปัะฑะพะผ ัะพััะพัะฝะธะธ
- ะัะธัะฐะตั `user_data`
- ะะพะทะฒัะฐัะฐะตั `ConversationHandler.END` (-1)

## ะะฑัะฐั ััะตะผะฐ ะฟะตัะตัะพะดะพะฒ ะผะตะถะดั ัะพััะพัะฝะธัะผะธ

```mermaid
graph TB
    subgraph "ะขะพัะบะฐ ะฒัะพะดะฐ"
        START[/start]
    end
    
    subgraph "ะะปะฐะฒะฝะพะต ะผะตะฝั"
        MAIN[CHOOSING_ACTION]
    end
    
    subgraph "ะะพะธัะบ ะฒ ะณะฐะปะตัะตะต"
        WEBAPP[WebApp ะะฐะปะตัะตะธ]
    end
    
    subgraph "ะะพะฑะฐะฒะปะตะฝะธะต ััะธะบะตััะตัะฐ"
        WAIT_PACK[WAITING_STICKER_PACK_LINK]
    end
    
    subgraph "ะกะพะทะดะฐะฝะธะต ะฝะพะฒะพะณะพ ะฝะฐะฑะพัะฐ"
        WAIT_TITLE[WAITING_NEW_TITLE]
        WAIT_STICKER1[WAITING_STICKER]
        WAIT_EMOJI1[WAITING_EMOJI]
        WAIT_DECISION1[WAITING_DECISION]
        WAIT_SHORT[WAITING_SHORT_NAME]
        WAIT_PUBLISH[WAITING_PUBLISH_DECISION]
    end
    
    subgraph "ะะพะฑะฐะฒะปะตะฝะธะต ะฒ ัััะตััะฒัััะธะน"
        WAIT_EXISTING[WAITING_EXISTING_CHOICE]
        WAIT_STICKER2[WAITING_STICKER]
        WAIT_EMOJI2[WAITING_EMOJI]
        WAIT_DECISION2[WAITING_DECISION]
    end
    
    subgraph "ะฃะฟัะฐะฒะปะตะฝะธะต ะฟัะฑะปะธะบะฐัะธะตะน"
        WAIT_MANAGE[WAITING_MANAGE_CHOICE]
    end
    
    START --> MAIN
    MAIN --> WEBAPP
    MAIN --> WAIT_PACK
    MAIN --> WAIT_EXISTING
    MAIN --> WAIT_TITLE
    MAIN --> WAIT_MANAGE
    
    WAIT_PACK --> MAIN
    WEBAPP -.->|ะฒะพะทะฒัะฐั| MAIN
    
    WAIT_TITLE --> WAIT_STICKER1
    WAIT_STICKER1 --> WAIT_EMOJI1
    WAIT_EMOJI1 --> WAIT_DECISION1
    WAIT_DECISION1 --> WAIT_STICKER1
    WAIT_DECISION1 --> WAIT_SHORT
    WAIT_SHORT --> WAIT_PUBLISH
    WAIT_PUBLISH --> END1[END]
    WAIT_TITLE --> END1
    
    WAIT_EXISTING --> WAIT_STICKER2
    WAIT_STICKER2 --> WAIT_EMOJI2
    WAIT_EMOJI2 --> WAIT_DECISION2
    WAIT_DECISION2 --> WAIT_STICKER2
    WAIT_DECISION2 --> END2[END]
    
    WAIT_MANAGE --> END3[END]
    
    style MAIN fill:#e1f5ff
    style WAIT_STICKER1 fill:#fff4e1
    style WAIT_STICKER2 fill:#fff4e1
    style WAIT_EMOJI1 fill:#ffe1f5
    style WAIT_EMOJI2 fill:#ffe1f5
```

## Callback-ะดะฐะฝะฝัะต (callback_data)

| Callback | ะะฟะธัะฐะฝะธะต | ะะฑัะฐะฑะพััะธะบ |
|----------|----------|------------|
| `add_pack_from_sticker` | ะะพะฑะฐะฒะธัั ััะธะบะตััะตั ะฒ ะณะฐะปะตัะตั | `handle_add_pack_from_sticker` |
| `manage_stickers_menu` | ะะพะบะฐะทะฐัั ะผะตะฝั ัะฟัะฐะฒะปะตะฝะธั ััะธะบะตัะฐะผะธ | `handle_manage_stickers_menu` |
| `back_to_main` | ะะตัะฝััััั ะฒ ะณะปะฐะฒะฝะพะต ะผะตะฝั | `handle_back_to_main` |
| `manage:create_new` | ะกะพะทะดะฐัั ะฝะพะฒัะน ััะธะบะตััะตั | `create_new_set` |
| `manage:add_existing` | ะะพะฑะฐะฒะธัั ะฒ ัััะตััะฒัััะธะน | `add_to_existing` |
| `manage:publication` | ะฃะฟัะฐะฒะปััั ะฟัะฑะปะธะบะฐัะธะตะน | `manage_publication` |
| `set:0`, `set:1`, ... | ะัะฑะพั ะฝะฐะฑะพัะฐ ะฟะพ ะธะฝะดะตะบัั | `handle_existing_choice` |
| `page:next` | ะกะปะตะดัััะฐั ัััะฐะฝะธัะฐ | `show_existing_sets` |
| `page:prev` | ะัะตะดัะดััะฐั ัััะฐะฝะธัะฐ | `show_existing_sets` |
| `action:cancel` | ะัะผะตะฝะฐ ะดะตะนััะฒะธั | `handle_existing_choice` |
| `manage:set:0`, `manage:set:1`, ... | ะัะฑะพั ะฝะฐะฑะพัะฐ ะดะปั ัะฟัะฐะฒะปะตะฝะธั | `handle_manage_choice` |
| `manage:page:next` | ะกะปะตะดัััะฐั ัััะฐะฝะธัะฐ (ัะฟัะฐะฒะปะตะฝะธะต) | `show_manage_sets` |
| `manage:page:prev` | ะัะตะดัะดััะฐั ัััะฐะฝะธัะฐ (ัะฟัะฐะฒะปะตะฝะธะต) | `show_manage_sets` |
| `manage:cancel` | ะัะผะตะฝะฐ ัะฟัะฐะฒะปะตะฝะธั | `handle_manage_choice` |
| `manage:unpublish` | ะกะฝััั ั ะฟัะฑะปะธะบะฐัะธะธ | `handle_manage_choice` |
| `manage:back` | ะะตัะฝััััั ะบ ัะฟะธัะบั | `handle_manage_choice` |
| `publish:yes` | ะะฟัะฑะปะธะบะพะฒะฐัั ะฝะฐะฑะพั | `handle_publish_choice` |
| `publish:no` | ะััะฐะฒะธัั ะฟัะธะฒะฐัะฝัะผ | `handle_publish_choice` |

## ะะฑัะฐะฑะพัะบะฐ ะพัะธะฑะพะบ

1. **ะัะธะฑะบะฐ ะพะฑัะฐะฑะพัะบะธ ะธะทะพะฑัะฐะถะตะฝะธั** โ ะฒะตัะฝััััั ะฒ `WAITING_STICKER`
2. **ะัะธะฑะบะฐ ัะพะทะดะฐะฝะธั ััะธะบะตััะตัะฐ** โ ะฒะตัะฝััััั ะฒ `WAITING_SHORT_NAME`
3. **ะัะธะฑะบะฐ ะดะพะฑะฐะฒะปะตะฝะธั ััะธะบะตัะฐ** โ ะฒะตัะฝััััั ะบ ะฒัะฑะพัั ะฝะฐะฑะพัะฐ
4. **ะะปะพะฑะฐะปัะฝะฐั ะพัะธะฑะบะฐ** โ ัะฒะตะดะพะผะธัั ะฟะพะปัะทะพะฒะฐัะตะปั, ะฟัะพะดะพะปะถะธัั ัะฐะฑะพัั
5. **ะัะธะฑะบะฐ ะทะฐะณััะทะบะธ ัะฟะธัะบะฐ ะฝะฐะฑะพัะพะฒ** โ ะทะฐะฒะตััะธัั ะดะธะฐะปะพะณ, ะฟัะตะดะปะพะถะธัั ะฝะฐัะฐัั ะทะฐะฝะพะฒะพ

## ะัะพะฑะตะฝะฝะพััะธ ัะตะฐะปะธะทะฐัะธะธ

### ะะฝะพะณะพะบัะฐัะฝะพะต ะธัะฟะพะปัะทะพะฒะฐะฝะธะต ัะพััะพัะฝะธะน
ะะตะบะพัะพััะต ัะพััะพัะฝะธั ะธัะฟะพะปัะทััััั ะฒ ัะฐะทะฝัั ะฟะพัะพะบะฐั:
- `WAITING_STICKER` โ ะดะปั ัะพะทะดะฐะฝะธั ะฝะพะฒะพะณะพ ะฝะฐะฑะพัะฐ ะธ ะดะพะฑะฐะฒะปะตะฝะธั ะฒ ัััะตััะฒัััะธะน
- `WAITING_EMOJI` โ ะพะฑัะตะต ัะพััะพัะฝะธะต ะดะปั ะฒัะตั ะพะฟะตัะฐัะธะน ัะพ ััะธะบะตัะฐะผะธ
- `WAITING_DECISION` โ ะธัะฟะพะปัะทัะตััั ะฒ ะพะฑะพะธั ะฟะพัะพะบะฐั ะดะพะฑะฐะฒะปะตะฝะธั ััะธะบะตัะพะฒ

### ะะฟัะตะดะตะปะตะฝะธะต ะบะพะฝัะตะบััะฐ ะดะตะนััะฒะธั
ะะตะนััะฒะธะต ะฟะพะปัะทะพะฒะฐัะตะปั ะพะฟัะตะดะตะปัะตััั ัะตัะตะท `context.user_data['action']`:
- `'create_new'` โ ัะพะทะดะฐะฝะธะต ะฝะพะฒะพะณะพ ััะธะบะตััะตัะฐ
- `'add_existing'` โ ะดะพะฑะฐะฒะปะตะฝะธะต ะฒ ัััะตััะฒัััะธะน ะฝะฐะฑะพั
- `'add_pack_from_sticker'` โ ะดะพะฑะฐะฒะปะตะฝะธะต ััะธะบะตััะตัะฐ ะฒ ะณะฐะปะตัะตั
- `'manage_publication'` โ ัะฟัะฐะฒะปะตะฝะธะต ะฟัะฑะปะธะบะฐัะธะตะน

### ะะฐะณะธะฝะฐัะธั
ะกะฟะธัะบะธ ะฝะฐะฑะพัะพะฒ ะพัะพะฑัะฐะถะฐัััั ั ะฟะฐะณะธะฝะฐัะธะตะน:
- ะะพ 10 ัะปะตะผะตะฝัะพะฒ ะฝะฐ ัััะฐะฝะธัั
- ะะฐะฒะธะณะฐัะธั ัะตัะตะท ะบะฝะพะฟะบะธ "โฌ๏ธ ะะฐะทะฐะด" / "โก๏ธ ะะฟะตัะตะด"
- ะกะพััะพัะฝะธะต ัััะฐะฝะธัั ััะฐะฝะธััั ะฒ `context.user_data`

## ะขะตะบััะพะฒะฐั ััะตะผะฐ ะฟะพะปัะทะพะฒะฐัะตะปััะบะธั ะฟััะตะน

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                           /start                                 โ
โโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                        โ
                        โผ
            โโโโโโโโโโโโโโโโโโโโโโโโโ
            โ  ะะปะฐะฒะฝะพะต ะผะตะฝั (0)     โ
            โ  CHOOSING_ACTION      โ
            โโโโโโโโโโโโโฌโโโโโโโโโโโโ
                        โ
        โโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโ
        โ               โ               โ                  โ
        โผ               โผ               โผ                  โผ
   [WebApp]     [ะะพะฑะฐะฒะธัั ะฟะฐะบ]  [ะฃะฟัะฐะฒะปะตะฝะธะต]         [ะััะณะธะต...]
                (WAITING_      โโโโโโโโโโโโโโโโโโโ
                 STICKER_      โ                 โ
                 PACK_LINK)    โ                 โ
                               โผ                 โ
                        โโโโโโโโโโโโโโโโโ        โ
                        โ ะะพะดะผะตะฝั       โ        โ
                        โโโโโโโโโฌโโโโโโโโ        โ
                                โ                 โ
                โโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโ
                โ               โ               โโ
                โผ               โผ               โผโ
        [ะกะพะทะดะฐัั ะฝะพะฒัะน]  [ะ ัััะตััะฒัััะธะน]  [ะัะฑะปะธะบะฐัะธั]
        WAITING_NEW_     WAITING_EXISTING  WAITING_MANAGE
        TITLE           _CHOICE            _CHOICE
                โ               โ               โ
                โผ               โผ               โผ
        [ะกะพะทะดะฐะฝะธะต...]   [ะะพะฑะฐะฒะปะตะฝะธะต...]   [ะฃะฟัะฐะฒะปะตะฝะธะต...]
                โ               โ               โ
                โโโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโโ
                                โ
                                โผ
                        โโโโโโโโโโโโโโโโโ
                        โ  ะะฐะฒะตััะตะฝะธะต   โ
                        โ  (END ะธะปะธ 0)  โ
                        โโโโโโโโโโโโโโโโโ

ะัะฝะพะฒะฝัะต ะฟะพัะพะบะธ:

1. ะะพะธัะบ ะฒ ะณะฐะปะตัะตะต:
   /start โ ะะปะฐะฒะฝะพะต ะผะตะฝั โ WebApp (ะฒะฝะตัะฝะตะต)

2. ะะพะฑะฐะฒะปะตะฝะธะต ััะธะบะตััะตัะฐ:
   /start โ ะะปะฐะฒะฝะพะต ะผะตะฝั โ WAITING_STICKER_PACK_LINK โ ะะปะฐะฒะฝะพะต ะผะตะฝั

3. ะกะพะทะดะฐะฝะธะต ะฝะพะฒะพะณะพ ะฝะฐะฑะพัะฐ:
   /start โ ะะปะฐะฒะฝะพะต ะผะตะฝั โ ะฃะฟัะฐะฒะปะตะฝะธะต โ ะกะพะทะดะฐัั ะฝะพะฒัะน โ
   WAITING_NEW_TITLE โ WAITING_STICKER โ WAITING_EMOJI โ
   WAITING_DECISION โ WAITING_SHORT_NAME โ WAITING_PUBLISH_DECISION โ END

4. ะะพะฑะฐะฒะปะตะฝะธะต ะฒ ัััะตััะฒัััะธะน:
   /start โ ะะปะฐะฒะฝะพะต ะผะตะฝั โ ะฃะฟัะฐะฒะปะตะฝะธะต โ ะ ัััะตััะฒัััะธะน โ
   WAITING_EXISTING_CHOICE โ WAITING_STICKER โ WAITING_EMOJI โ
   WAITING_DECISION โ END

5. ะฃะฟัะฐะฒะปะตะฝะธะต ะฟัะฑะปะธะบะฐัะธะตะน:
   /start โ ะะปะฐะฒะฝะพะต ะผะตะฝั โ ะฃะฟัะฐะฒะปะตะฝะธะต โ ะัะฑะปะธะบะฐัะธั โ
   WAITING_MANAGE_CHOICE โ END
```

